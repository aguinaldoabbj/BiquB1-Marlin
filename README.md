Based on Luigisvc's Marlin Sources customizations.
